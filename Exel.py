import pandas as pd

# Справочник зон (уникальные коды)
zones = [
    "Ж-1", "Ж-2", "Ж-3", "Ж-4",
    "О-1", "О-2", "О-3_спорт", "О-3_образование", "О-4", "О-6", "ОЖ",
    "Р-1", "Р-2", "Р-3_вне_НП", "Р-3_ландшафты", "Р-4", "Р-5", "КЗ",
    "П-1", "П-2", "П-3_опасность", "П-3_Ладушкин", "П-4", "П-5_вне_НП", "П-5_Янтарный",
    "И",
    "Т-1", "Т-2", "Т-3_авиа", "Т-3_Ладушкин", "Т-4",
    "Сп-1", "Сп-2", "Сп-3", "Сп-4",
    "Сх-1", "Сх-2", "Сх-3", "Сх-4", "Сх-5",
    "Лес", "Вода"
]

n = len(zones)
df = pd.DataFrame(0, index=zones, columns=zones, dtype=int)

# 1. Каждая зона совместима сама с собой
for z in zones:
    df.loc[z, z] = 1

# 2. Группы совместимых зон
# --- Группа 1: Жилые низкой этажности + общественно-жилая + сельская + рекреация ---
group1 = {"Ж-3", "Ж-4", "ОЖ", "Сх-4", "Сх-5", "Р-1", "Р-2", "Р-5", "КЗ", "О-2", "О-3_спорт", "О-3_образование", "О-4", "Сп-4"}
for a in group1:
    for b in group1:
        if a in df.index and b in df.columns:
            df.loc[a, b] = 1

# --- Группа 2: Сельхоз (базовые) ---
group2 = {"Сх-1", "Сх-2", "Сх-3"}
for a in group2:
    for b in group2:
        df.loc[a, b] = 1
# Сх-1-3 → Сх-4/5 (односторонне)
for a in group2:
    for b in ["Сх-4", "Сх-5"]:
        df.loc[a, b] = 1

# --- Группа 3: Производственные (низкий класс опасности) ---
group3 = {"П-3_опасность", "П-3_Ладушкин", "П-4", "П-5_вне_НП", "П-5_Янтарный"}
for a in group3:
    for b in group3:
        df.loc[a, b] = 1

# --- Группа 4: Транспорт (ограниченно) ---
# Т-2 совместим с О-1 и П-4 (парковки, логистика)
df.loc["Т-2", "О-1"] = 1
df.loc["Т-2", "П-4"] = 1
df.loc["О-1", "Т-2"] = 1  # взаимно
df.loc["П-4", "Т-2"] = 1

# --- Группа 5: Специальные ---
df.loc["Сп-4", "Р-1"] = 1
df.loc["Сп-4", "Р-4"] = 1
df.loc["Р-1", "Сп-4"] = 1
df.loc["Р-4", "Сп-4"] = 1

# --- ОЖ совместима с Ж-2 (в центре) ---
df.loc["ОЖ", "Ж-2"] = 1
df.loc["Ж-2", "ОЖ"] = 1

# --- Земли фонда: только сами с собой (уже стоит 1 по диагонали) — всё остальное 0

# 3. Сохранение
df.to_excel("Совместимость_зон_Калининград_географ.xlsx")
print("✅ Файл с географически обоснованной совместимостью создан!")